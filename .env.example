# ===================================================================
# BANK STATEMENT SEPARATOR CONFIGURATION
# Copy this file to .env and customize for your environment
# ===================================================================

# ===================================================================
# LLM PROVIDER CONFIGURATION
# ===================================================================

# LLM Provider Selection
# Choose: openai, ollama, or auto (fallback)
# Recommended: ollama with mistral:instruct for best accuracy
LLM_PROVIDER=ollama

# OpenAI Configuration (when LLM_PROVIDER=openai)
OPENAI_API_KEY=sk-your-api-key-here
OPENAI_MODEL=gpt-4o-mini

# Ollama Configuration (when LLM_PROVIDER=ollama)
# mistral:instruct has 100% boundary detection accuracy
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=mistral:instruct

# General LLM Settings
LLM_TEMPERATURE=0
LLM_MAX_TOKENS=4000
LLM_FALLBACK_ENABLED=true

# ===================================================================
# PROCESSING CONFIGURATION
# ===================================================================

# Text Processing Settings
CHUNK_SIZE=6000
CHUNK_OVERLAP=800

# File Processing Limits
MAX_FILE_SIZE_MB=100
MAX_PAGES_PER_STATEMENT=50
MAX_TOTAL_PAGES=500

# Output Configuration
DEFAULT_OUTPUT_DIR=./separated_statements
PROCESSED_INPUT_DIR=./input/processed
MAX_FILENAME_LENGTH=240
INCLUDE_BANK_IN_FILENAME=true
DATE_FORMAT=YYYY-MM

# Processing Behavior
ENABLE_FALLBACK_PROCESSING=true

# ===================================================================
# SECURITY & LOGGING CONFIGURATION
# ===================================================================

# Logging Settings
LOG_LEVEL=INFO
LOG_FILE=./logs/statement_processing.log
ENABLE_AUDIT_LOGGING=true

# Security Controls (REQUIRED for production)
# Uncomment and configure these for production use
# ALLOWED_INPUT_DIRS=/secure/input,/approved/documents
# ALLOWED_OUTPUT_DIRS=/secure/output,/processed/statements

# ===================================================================
# PAPERLESS-NGX INTEGRATION (Optional)
# ===================================================================

# Basic Connection Settings
PAPERLESS_ENABLED=false
PAPERLESS_URL=http://localhost:8000
PAPERLESS_TOKEN=your-api-token-here

# Output Document Configuration
# Tags applied to separated bank statements (comma-separated)
PAPERLESS_TAGS=bank-statement,automated
PAPERLESS_CORRESPONDENT=Bank
PAPERLESS_DOCUMENT_TYPE=Bank Statement
PAPERLESS_STORAGE_PATH=Bank Statements
PAPERLESS_TAG_WAIT_TIME=5

# Input Document Retrieval (for processing documents from Paperless)
PAPERLESS_INPUT_TAGS=unprocessed,bank-statement-raw
PAPERLESS_INPUT_CORRESPONDENT=
PAPERLESS_INPUT_DOCUMENT_TYPE=
PAPERLESS_MAX_DOCUMENTS=50
PAPERLESS_QUERY_TIMEOUT=30

# Input Document Processing Tracking
# Configure ONE of these options to mark input documents as processed:
PAPERLESS_INPUT_TAGGING_ENABLED=true

# Option 1: Add a "processed" tag after successful processing
PAPERLESS_INPUT_PROCESSED_TAG=processed

# Option 2: Remove "unprocessed" tag after successful processing
# PAPERLESS_INPUT_REMOVE_UNPROCESSED_TAG=true
# PAPERLESS_INPUT_UNPROCESSED_TAG_NAME=unprocessed

# Option 3: Add a custom processing tag
# PAPERLESS_INPUT_PROCESSING_TAG=bank-statement-processed

# ===================================================================
# ERROR DETECTION & TAGGING (Advanced Feature)
# ===================================================================

# Enable automatic error detection and tagging
PAPERLESS_ERROR_DETECTION_ENABLED=false

# Tags applied to documents with processing errors
PAPERLESS_ERROR_TAGS=processing:needs-review,error:automated-detection

# Error detection sensitivity (0.0=all errors, 1.0=critical only)
PAPERLESS_ERROR_TAG_THRESHOLD=0.5

# Error severity levels that trigger tagging
PAPERLESS_ERROR_SEVERITY_LEVELS=medium,high,critical

# Tagging performance mode (false=individual, true=batch)
PAPERLESS_ERROR_BATCH_TAGGING=false

# Example configurations:
# Production (conservative): threshold=0.7, levels=high,critical
# Development (comprehensive): threshold=0.0, levels=low,medium,high,critical

# ===================================================================
# ERROR HANDLING & VALIDATION
# ===================================================================

# Error Recovery Settings
QUARANTINE_DIRECTORY=./quarantine
MAX_RETRY_ATTEMPTS=2
CONTINUE_ON_VALIDATION_WARNINGS=true
AUTO_QUARANTINE_CRITICAL_FAILURES=true
PRESERVE_FAILED_OUTPUTS=true

# Error Reporting
ENABLE_ERROR_REPORTING=true
ERROR_REPORT_DIRECTORY=./error_reports

# Document Validation
VALIDATION_STRICTNESS=normal
MIN_PAGES_PER_STATEMENT=1
MAX_FILE_AGE_DAYS=365
ALLOWED_FILE_EXTENSIONS=.pdf
REQUIRE_TEXT_CONTENT=true
MIN_TEXT_CONTENT_RATIO=0.1

# ===================================================================
# DEVELOPMENT & TESTING
# ===================================================================

# Development Mode Settings (disable for production)
# DEVELOPMENT_MODE=true
# DEBUG_OUTPUT_DIR=./debug
# PRESERVE_INTERMEDIATE_FILES=true
# ENABLE_PROFILING=true

# Test Mode Settings (for automated testing)
# TEST_MODE=true
# MOCK_API_RESPONSES=true
# TEST_DATA_DIR=./test/input
# GENERATE_TEST_REPORTS=true

# ===================================================================
# PRODUCTION DEPLOYMENT NOTES
# ===================================================================
#
# For production deployment:
# 1. Set OPENAI_API_KEY or configure Ollama
# 2. Enable security controls (ALLOWED_*_DIRS)
# 3. Configure Paperless-ngx integration if needed
# 4. Set LOG_LEVEL=INFO or WARNING
# 5. Enable PAPERLESS_ERROR_DETECTION_ENABLED for monitoring
# 6. Use strong API tokens and rotate regularly
# 7. Set up log rotation and monitoring
# 8. Configure appropriate file size and processing limits
#
# Security checklist:
# - [ ] API keys stored securely
# - [ ] File access restrictions configured
# - [ ] Log files secured and rotated
# - [ ] Error reports protected
# - [ ] Quarantine directory monitored
# - [ ] Network access restricted
# - [ ] Paperless tokens have minimal required permissions
#
# ===================================================================
